<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TikTok Style Page</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            touch-action: none;
        }

        body {
            overflow: hidden;
            background: #000;
        }

        .container {
            height: 100vh;
            position: relative;
        }

        .folder {
            width: 100vw;
            height: 100vh;
            position: absolute;
            transform: translateY(100%);
            transition: transform 0.5s;
        }

        .folder.active {
            transform: translateY(0);
        }

        .content-container {
            display: flex;
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: relative;
        }

        .content {
            flex: 0 0 100%;
            height: 100%;
            position: relative;
            transition: transform 0.5s;
        }

        video, img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .audio-container {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 文件夹1 - 图片集 -->
        <div class="folder active">
            <audio class="audio-container" loop src="250113.mp3"></audio>
            <div class="content-container">
                <div class="content"><img src="250113-1.webp"></div>
                <div class="content"><img src="250113-2.webp"></div>
                <div class="content"><img src="250113-3.webp"></div>
                <div class="content"><img src="250113-4.webp"></div>
                <div class="content"><img src="250113-5.webp"></div>
                <div class="content"><img src="250113-6.webp"></div>
                <div class="content"><img src="250113-7.webp"></div>
            </div>
        </div>

        <!-- 文件夹2 - 视频集 -->
        <div class="folder">
            <audio class="audio-container" loop src="241116.mp3"></audio>
            <div class="content-container">
                <div class="content">
                    <video src="241116-1.mp4" loop muted="false"></video>
                </div>
                <div class="content">
                    <video src="241116-2.mp4" loop muted="false"></video>
                </div>
            </div>
        </div>
    </div>

    <script>
        class TikTokPlayer {
            constructor() {
                this.folders = Array.from(document.querySelectorAll('.folder'));
                this.currentFolderIndex = 0;
                this.currentContentIndex = 0;
                this.autoPlayTimer = null;
                this.isPlaying = true;

                this.init();
            }

            init() {
                this.addEventListeners();
                this.activateFolder(this.currentFolderIndex);
                this.startAutoPlay();
                this.enableVideoAudio();
            }

            enableVideoAudio() {
                // 确保视频声音可以播放
                document.querySelectorAll('video').forEach(video => {
                    video.muted = false;
                });
            }

            addEventListeners() {
                let touchStartX = 0;
                let touchStartY = 0;
                let isHorizontal = false;

                document.addEventListener('touchstart', e => {
                    touchStartX = e.touches[0].clientX;
                    touchStartY = e.touches[0].clientY;
                    isHorizontal = false;
                });

                document.addEventListener('touchmove', e => {
                    if (!this.isPlaying) return;
                    
                    const deltaX = e.touches[0].clientX - touchStartX;
                    const deltaY = e.touches[0].clientY - touchStartY;

                    if (!isHorizontal && Math.abs(deltaX) > Math.abs(deltaY)) {
                        isHorizontal = true;
                    }
                });

                document.addEventListener('touchend', e => {
                    if (!this.isPlaying) return;

                    const deltaX = e.changedTouches[0].clientX - touchStartX;
                    const deltaY = e.changedTouches[0].clientY - touchStartY;

                    if (isHorizontal) {
                        this.handleHorizontalSwipe(deltaX);
                    } else {
                        this.handleVerticalSwipe(deltaY);
                    }
                });

                document.addEventListener('click', () => this.togglePlay());
            }

            handleVerticalSwipe(deltaY) {
                if (Math.abs(deltaY) < 50) return;

                if (deltaY > 0) {
                    this.switchFolder(-1);
                } else {
                    this.switchFolder(1);
                }
            }

            handleHorizontalSwipe(deltaX) {
                if (Math.abs(deltaX) < 50) return;

                if (deltaX > 0) {
                    this.switchContent(-1);
                } else {
                    this.switchContent(1);
                }
                this.resetAutoPlay();
            }

            switchFolder(direction) {
                const newIndex = this.currentFolderIndex + direction;
                if (newIndex >= 0 && newIndex < this.folders.length) {
                    this.deactivateFolder(this.currentFolderIndex);
                    this.currentFolderIndex = newIndex;
                    this.activateFolder(newIndex);
                }
            }

            switchContent(direction) {
                const contents = this.getCurrentContents();
                const newIndex = (this.currentContentIndex + direction + contents.length) % contents.length;
                
                contents[this.currentContentIndex].style.transform = `translateX(${direction * -100}%)`;
                contents[newIndex].style.transform = 'translateX(0)';
                this.currentContentIndex = newIndex;
            }

            activateFolder(index) {
                const folder = this.folders[index];
                folder.classList.add('active');
                this.currentContentIndex = 0;
                this.playCurrentMedia();
                this.resetAutoPlay();
            }

            deactivateFolder(index) {
                const folder = this.folders[index];
                folder.classList.remove('active');
                this.pauseFolderMedia(index);
            }

            playCurrentMedia() {
                const folder = this.folders[this.currentFolderIndex];
                const audio = folder.querySelector('audio');
                const currentContent = this.getCurrentContents()[this.currentContentIndex];
                
                if (audio) audio.play().catch(e => console.log('音频播放需要用户交互'));
                if (currentContent.querySelector('video')) {
                    currentContent.querySelector('video').play().catch(e => console.log('视频播放需要用户交互'));
                }
            }

            pauseFolderMedia(index) {
                const folder = this.folders[index];
                folder.querySelector('audio').pause();
                folder.querySelectorAll('video').forEach(v => v.pause());
            }

            startAutoPlay() {
                this.autoPlayTimer = setInterval(() => {
                    if (this.isPlaying) {
                        const currentContent = this.getCurrentContents()[this.currentContentIndex];
                        if (currentContent.querySelector('img')) {
                            this.switchContent(1);
                        }
                    }
                }, 3000);
            }

            resetAutoPlay() {
                clearInterval(this.autoPlayTimer);
                this.startAutoPlay();
            }

            togglePlay() {
                this.isPlaying = !this.isPlaying;
                const folder = this.folders[this.currentFolderIndex];
                
                if (this.isPlaying) {
                    folder.querySelector('audio').play();
                    this.getCurrentContents().forEach(content => {
                        const video = content.querySelector('video');
                        if (video) video.play();
                    });
                    this.resetAutoPlay();
                } else {
                    folder.querySelector('audio').pause();
                    this.getCurrentContents().forEach(content => {
                        const video = content.querySelector('video');
                        if (video) video.pause();
                    });
                    clearInterval(this.autoPlayTimer);
                }
            }

            getCurrentContents() {
                return Array.from(
                    this.folders[this.currentFolderIndex]
                        .querySelector('.content-container')
                        .children
                );
            }
        }

        // 初始化播放器
        new TikTokPlayer();
    </script>
</body>
</html>